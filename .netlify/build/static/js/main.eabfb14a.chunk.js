(this["webpackJsonpreact-news"]=this["webpackJsonpreact-news"]||[]).push([[0],{25:function(t,e,a){t.exports=a(55)},30:function(t,e,a){},31:function(t,e,a){},55:function(t,e,a){"use strict";a.r(e);var n=a(0),c=a.n(n),o=a(21),r=a.n(o),s=(a(30),a(1)),i=a(2),l=a(4),u=a(3),m=a(5),p=(a(31),a(6)),h=a(8),d=a.n(h),g=function(t){return d.a.get("https://toms-news-api.herokuapp.com/api/articles",{params:{p:t&&t.page,topic:t&&t.topic,sort_by:t&&t.sortBy,order:t&&t.order}}).then((function(t){var e=t.data;return{articles:e.articles,total_articles:e.total_count}}))},f=function(t){return d.a.get("https://toms-news-api.herokuapp.com/api/articles/".concat(t)).then((function(t){return t.data.article}))},v=function(t,e){return d.a.get("https://toms-news-api.herokuapp.com/api/articles/".concat(t,"/comments"),{params:{p:e&&e.page}}).then((function(t){return t.data.comments}))},E=function(t,e,a){return d.a.post("https://toms-news-api.herokuapp.com/api/articles/".concat(t,"/comments"),{username:e,body:a}).then((function(t){return t.data.comment}))},b=function(t){return d.a.delete("https://toms-news-api.herokuapp.com/api/comments/".concat(t))},C=function(t,e){return d.a.patch("https://toms-news-api.herokuapp.com/api/articles/".concat(t),{inc_votes:e})},k=function(t,e){return d.a.patch("https://toms-news-api.herokuapp.com/api/comments/".concat(t),{inc_votes:e})};function _(t){return c.a.createElement("header",{className:"header"},c.a.createElement("h1",null,"NC News"))}var y=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={topicList:[],curOption:"Select a topic"},a.handleClick=function(t){"notChose"!==t.target.value?(Object(p.c)("/topics/".concat(t.target.value)),a.setState({curOption:t.target.value})):(Object(p.c)("/articles"),a.setState({curOption:"Select a topic"}))},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){return c.a.createElement("select",{name:"topicSelect",id:"topicNav",onChange:this.handleClick,value:this.state.curOption},c.a.createElement("option",{value:"notChose"},"Select a topic"),this.state.topicList.map((function(t){return c.a.createElement("option",{key:t.slug,value:t.slug},t.slug)})))}},{key:"componentDidMount",value:function(){var t=this;d.a.get("https://toms-news-api.herokuapp.com/api/topics").then((function(t){return t.data.topics})).then((function(e){t.setState({topicList:e})}))}},{key:"componentDidUpdate",value:function(){this.props.setDefault&&(this.setState({curOption:"Select a topic"}),this.props.resetDefault())}}]),e}(n.Component),O=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={setDefault:!1},a.handleClick=function(){a.setState({setDefault:!0})},a.resetDefault=function(){a.setState({setDefault:!1})},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){return c.a.createElement("nav",{className:"nav"},c.a.createElement(p.a,{to:"/"},c.a.createElement("button",{onClick:this.handleClick},"Home")),c.a.createElement(p.a,{to:"/articles"},c.a.createElement("button",{onClick:this.handleClick},"All articles")),c.a.createElement(y,{setDefault:this.state.setDefault,resetDefault:this.resetDefault}))}}]),e}(n.Component),j=a(10),w=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={votes:0,upvoteClicked:!1,downvoteClicked:!1},a.handleUpVoteClick=function(t){var e=Number(t.target.value);a.state.upvoteClicked&&(e=-1),a.setState((function(t){return{votes:t.votes+e,upvoteClicked:!t.upvoteClicked}})),a.updateVotes(e)},a.handleDownVoteClick=function(t){var e=Number(t.target.value);a.state.downvoteClicked&&(e=1),a.setState((function(t){return{votes:t.votes+e,downvoteClicked:!t.downvoteClicked}})),a.updateVotes(e)},a.updateVotes=function(t){a.props.article_id?C(a.props.article_id,t):a.props.comment_id&&k(a.props.comment_id,t)},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){return c.a.createElement("section",{className:"votingSection"},c.a.createElement("section",{className:"votingBtns"},c.a.createElement("button",{disabled:!this.props.user||!0===this.state.downvoteClicked,value:"1",onClick:this.handleUpVoteClick,className:this.state.upvoteClicked?"upvoteClicked":"voteBtn"},"\u2191"),c.a.createElement("button",{disabled:!this.props.user||!0===this.state.upvoteClicked,value:"-1",onClick:this.handleDownVoteClick,className:this.state.downvoteClicked?"downvoteClicked":"voteBtn"},"\u2193")),c.a.createElement("p",null,"Votes:",this.state.votes))}},{key:"componentDidMount",value:function(){this.setState({votes:this.props.votes})}}]),e}(n.Component),S=/\d{4}-\d{2}-\d{2}/;function P(t){return c.a.createElement("section",{className:"articleCard"},c.a.createElement("section",{className:"articleCardText"},c.a.createElement(p.a,{to:"/articles/".concat(t.article.article_id)},c.a.createElement("li",null,t.article.title)),c.a.createElement("p",null,c.a.createElement("i",null,"Created on"," ",t.article.created_at.match(S)[0].split("-").reverse().join("-")))),c.a.createElement(w,{user:t.user,votes:t.article.votes,article_id:t.article.article_id}))}function L(t){return c.a.createElement("select",{name:"articleSort",onChange:t.changeQuery},c.a.createElement("option",{value:"default"},"Most recent"),c.a.createElement("option",{value:"order=asc"},"Oldest first"),c.a.createElement("option",{value:"sortBy=comment_count"},"Most commented"),c.a.createElement("option",{value:"sortBy=comment_count=order=asc"},"Least commented"),c.a.createElement("option",{value:"sortBy=votes"},"Most popular"),c.a.createElement("option",{value:"sortBy=votes=order=asc"},"Least popular"))}var N=a(23),A=a.n(N);function D(){return c.a.createElement("section",{className:"loadingElement"},c.a.createElement(A.a,{type:"bubbles",color:"black",className:"loadingBubbles"}))}var U=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={articles:[],total_articles:0,curPage:1,article_count:0,sortQuery:{sortBy:null,order:null},isLoading:!0},a.nextPage=function(){a.state.article_count<a.state.total_articles&&(a.setState({isLoading:!0}),a.fetchArticles(Object(j.a)({page:a.state.curPage+1},a.state.sortQuery),{inc:!0}))},a.prevPage=function(){a.state.curPage>1&&(a.setState({isLoading:!0}),a.fetchArticles(Object(j.a)({page:a.state.curPage-1},a.state.sortQuery),{dec:!0}))},a.fetchArticles=function(t,e){e?(e.inc&&g(t).then((function(t){var e=t.articles;a.setState((function(t){return{articles:e,curPage:t.curPage+1,article_count:t.article_count+e.length,isLoading:!1}}))})),e.dec&&g(t).then((function(t){var e=t.articles;a.setState((function(t){return{articles:e,curPage:t.curPage-1,article_count:t.article_count-t.articles.length,isLoading:!1}}))})),e.update&&g(t).then((function(t){var e=t.articles;a.setState({articles:e,isLoading:!1})}))):g(t).then((function(t){var e=t.articles,n=t.total_articles;a.setState({articles:e,total_articles:n,article_count:e.length,isLoading:!1})}))},a.changeSortQuery=function(t){if("default"!==t.target.value){var e=t.target.value.split("="),n={};e.forEach((function(t,a){a%2===0&&(n[t]=e[a+1])})),a.setState({sortQuery:n,isLoading:!0})}else a.setState({sortQuery:{sortBy:null,order:null},isLoading:!0})},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){var t=this;return c.a.createElement("section",{className:"articlesPage"},c.a.createElement("br",null),c.a.createElement(L,{changeQuery:this.changeSortQuery}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("button",{onClick:this.prevPage},"<"," "),c.a.createElement("button",{onClick:this.nextPage},">"),this.state.isLoading?c.a.createElement(D,null):c.a.createElement("ul",{className:"allArticlesList"},this.state.articles.map((function(e){return c.a.createElement(P,{article:e,key:e.article_id,user:t.props.user})}))),c.a.createElement("button",{onClick:this.prevPage},"<"," "),c.a.createElement("button",{onClick:this.nextPage},">"))}},{key:"componentDidMount",value:function(){this.fetchArticles(Object(j.a)({page:this.state.curPage},this.state.sortQuery))}},{key:"componentDidUpdate",value:function(t,e){e.sortQuery.sortBy===this.state.sortQuery.sortBy&&e.sortQuery.order===this.state.sortQuery.order||this.fetchArticles(Object(j.a)({page:this.state.curPage},this.state.sortQuery),{update:!0})}}]),e}(n.Component),I=a(24),B=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={commentInput:"Enter your comment here."},a.validateInput=function(t){a.setState({commentInput:t.target.value})},a.removeDefaultText=function(t){"Enter your comment here."===t.target.value&&a.setState({commentInput:""})},a.handleSubmit=function(t){t.preventDefault();var e=t.target.children.commentInput.value;"Enter your comment here."!==e&&e.length>0&&E(Number(a.props.article_id),a.props.user,e).then((function(){a.props.commentIsAdded()})).catch((function(t){return console.dir(t)}))},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){return this.props.user?c.a.createElement("section",{className:"commentAdder"},c.a.createElement("form",{onSubmit:this.handleSubmit},c.a.createElement("b",null,this.props.user," : "),c.a.createElement("textarea",{id:"commentInput",value:this.state.commentInput,onChange:this.validateInput,onClick:this.removeDefaultText}),c.a.createElement("br",null),""===this.state.commentInput&&c.a.createElement("p",null,"You cant comment nothing!"),c.a.createElement("button",{type:"submit"},"Add comment."))):c.a.createElement("p",null,"You must be logged in to add a comment! ")}}]),e}(n.Component);function Q(t){return c.a.createElement("section",{className:"commentAndVotes"},c.a.createElement("li",{className:"commentCard"},c.a.createElement("b",null,t.comment.author," : ")," ",t.comment.body)," ",c.a.createElement(w,{user:t.user,comment_id:t.comment.comment_id,votes:t.comment.votes}),t.user===t.comment.author&&c.a.createElement("button",{id:t.comment.comment_id,onClick:t.handleClick,className:"commentDelBtn"},"Delete comment"))}var M=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={comments:[],total_comments:0,comment_count:0,curPage:1},a.fetchComments=function(){v(a.props.article_id).then((function(t){a.setState({comments:t,total_comments:a.props.total_comments,comment_count:t.length,curPage:1})}))},a.commentIsAdded=function(){a.fetchComments()},a.handleDeleteClick=function(t){b(t.target.id).then((function(){a.fetchComments()}))},a.loadNextPage=function(){a.state.comment_count<a.state.total_comments&&v(a.props.article_id,{page:a.state.curPage+1}).then((function(t){a.setState((function(e){var a=e.comments.map((function(t){return Object.assign({},t)}));return a.push.apply(a,Object(I.a)(t)),{comments:a,curPage:e.curPage+1,comment_count:e.comment_count+t.length}}))}))},a.loadFirstPage=function(){a.fetchComments()},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){var t=this;return 0===this.state.comments.length?c.a.createElement(D,null):c.a.createElement("section",{className:"articleComments"},c.a.createElement("br",null),c.a.createElement(B,{user:this.props.user,article_id:this.props.article_id,commentIsAdded:this.commentIsAdded}),c.a.createElement("ul",null,this.state.comments.map((function(e){return c.a.createElement(Q,{user:t.props.user,comment:e,key:e.comment_id,handleClick:t.handleDeleteClick})}))),this.state.comment_count<this.state.total_comments?c.a.createElement(p.a,{to:"/articles/".concat(this.props.article_id,"/comments"),onClick:this.loadNextPage},"Show more comments"):this.state.curPage>1&&c.a.createElement(p.a,{to:"/articles/".concat(this.props.article_id,"/comments"),onClick:this.loadFirstPage},"Show less"))}},{key:"componentDidMount",value:function(){var t=this;this.fetchComments(),this.state.total_comments||this.props.getCommentTotal().then((function(e){return t.setState({total_comments:e})})),this.props.trueOnMount()}}]),e}(n.Component),x=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={article:{},showComment:!1},a.showHideComments=function(){a.setState((function(t){return t.showComment?Object(p.c)("/articles/".concat(a.props.article_id)):Object(p.c)("/articles/".concat(a.props.article_id,"/comments")),{showComment:!t.showComment}}))},a.getCommentCount=function(){return f(a.props.article_id).then((function(t){return t.comment_count}))},a.setTrueOnCommentsMount=function(){a.setState({showComment:!0})},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){return this.state.article.title?c.a.createElement("section",{className:"singleArticlePage"},c.a.createElement("h4",null,this.state.article.title),c.a.createElement("p",null,this.state.article.body),c.a.createElement("p",null,c.a.createElement("i",null,"Written by ",this.state.article.author)),c.a.createElement("button",{onClick:this.showHideComments},this.state.showComment?"Hide comments":"Show comments (".concat(this.state.article.comment_count,")")),c.a.createElement(p.b,null,c.a.createElement(M,{path:"/comments",user:this.props.user,total_comments:this.state.article.comment_count,getCommentTotal:this.getCommentCount,trueOnMount:this.setTrueOnCommentsMount}))):c.a.createElement(D,null)}},{key:"componentDidMount",value:function(){var t=this;f(this.props.article_id).then((function(e){t.setState({article:e})}))}}]),e}(n.Component),V=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={topic_articles:[],total_articles:0,curPage:1,article_count:0,isLoading:!0},a.fetchArticles=function(){a.setState({isLoading:!0}),g({topic:a.props.topic_slug}).then((function(t){var e=t.articles,n=t.total_articles;a.setState({topic_articles:e,total_articles:n,article_count:e.length,curPage:1,isLoading:!1})}))},a.nextPage=function(){a.state.article_count<a.state.total_articles&&(a.setState({isLoading:!0}),g({page:a.state.curPage+1,topic:a.props.topic_slug}).then((function(t){var e=t.articles;a.setState((function(t){return{topic_articles:e,curPage:t.curPage+1,article_count:t.article_count+e.length,isLoading:!1}}))})))},a.prevPage=function(){a.state.curPage>1&&(a.setState({isLoading:!0}),g({page:a.state.curPage-1,topic:a.props.topic_slug}).then((function(t){var e=t.articles;a.setState((function(t){return{topic_articles:e,curPage:t.curPage-1,article_count:t.article_count-e.length,isLoading:!1}}))})))},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){var t=this;return c.a.createElement("section",{className:"topicList"},c.a.createElement("h2",null,"Topic : ",this.props.topic_slug),c.a.createElement("button",{onClick:this.prevPage},"<"," "),c.a.createElement("button",{onClick:this.nextPage},">"),this.state.isLoading?c.a.createElement(D,null):c.a.createElement("ul",{className:"topicArticleList"},this.state.topic_articles.map((function(e){return c.a.createElement(P,{article:e,key:e.article_id,user:t.props.user})}))),c.a.createElement("button",{onClick:this.prevPage},"<"," "),c.a.createElement("button",{onClick:this.nextPage},">"))}},{key:"componentDidMount",value:function(){this.fetchArticles()}},{key:"componentDidUpdate",value:function(t){t.topic_slug!==this.props.topic_slug&&this.fetchArticles()}}]),e}(n.Component),T=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={users:[]},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){var t=this;return 0===this.state.users.length?c.a.createElement(D,null):this.props.user?c.a.createElement("section",{className:"homePage"},c.a.createElement("p",null,"You are logged in as: ",this.props.user),c.a.createElement("button",{value:null,onClick:this.props.handleLogin},"Logout")):c.a.createElement("section",{className:"homePage"},c.a.createElement("h3",null,"Login"),this.state.users.map((function(e){return c.a.createElement("p",{key:e.username},c.a.createElement("img",{className:"loginAvatar",src:e.avatar_url,alt:"".concat(e.username," profile avatar")}),c.a.createElement("br",null),e.username," ",c.a.createElement("button",{value:e.username,onClick:t.props.handleLogin},"Login"))})))}},{key:"componentDidMount",value:function(){var t=this;d.a.get("https://toms-news-api.herokuapp.com/api/users").then((function(t){return t.data.users})).then((function(e){t.setState({users:e})}))}}]),e}(n.Component);function H(t){return c.a.createElement("section",{className:"logInfo"},t.loggedUser?c.a.createElement("div",null,c.a.createElement("label",null,c.a.createElement("img",{src:t.loggedUserImg,alt:"".concat(t.loggedUser," profile avatar"),className:"smallLoginAvatar"}),c.a.createElement("br",null),t.loggedUser),c.a.createElement("br",null),c.a.createElement("button",{value:null,onClick:t.handleLogin,id:"permLogoutBtn"},"Logout")):c.a.createElement(p.a,{to:"/"},c.a.createElement("button",null,"Login")))}var W=function(t){function e(){var t,a;Object(s.a)(this,e);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(l.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(c)))).state={loggedUser:null,loggedUserImg:null},a.handleLoginLogout=function(t){var e=t.target.value;a.setState({loggedUser:e})},a}return Object(m.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){return c.a.createElement("div",{className:"App"},c.a.createElement(H,{loggedUser:this.state.loggedUser,loggedUserImg:this.state.loggedUserImg,handleLogin:this.handleLoginLogout}),c.a.createElement(_,{user:this.state.loggedUser,className:"header"}),c.a.createElement(O,null),c.a.createElement(p.b,{className:"mainContent"},c.a.createElement(T,{path:"/",user:this.state.loggedUser,handleLogin:this.handleLoginLogout}),c.a.createElement(U,{path:"/articles",user:this.state.loggedUser}),c.a.createElement(x,{path:"/articles/:article_id/*",user:this.state.loggedUser}),c.a.createElement(V,{path:"/topics/:topic_slug",user:this.state.loggedUser})))}},{key:"componentDidUpdate",value:function(t,e){var a,n=this;e.loggedUser!==this.state.loggedUser&&this.state.loggedUser&&(a=this.state.loggedUser,d.a.get("https://toms-news-api.herokuapp.com/api/users/".concat(a)).then((function(t){return t.data.user}))).then((function(t){n.setState({loggedUserImg:t.avatar_url})}))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[25,1,2]]]);
//# sourceMappingURL=main.eabfb14a.chunk.js.map