(this["webpackJsonpreact-news"]=this["webpackJsonpreact-news"]||[]).push([[0],{25:function(e,t,a){e.exports=a(55)},30:function(e,t,a){},31:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(22),c=a.n(o),s=(a(30),a(2)),i=a(3),l=a(5),u=a(4),m=a(6),p=(a(31),a(1)),h=a(8),d=a.n(h),g=function(e){return d.a.get("https://toms-news-api.herokuapp.com/api/articles",{params:{p:e&&e.page,topic:e&&e.topic,author:e&&e.author,sort_by:e&&e.sortBy,order:e&&e.order}}).then((function(e){var t=e.data;return{articles:t.articles,total_articles:t.total_count}}))},f=function(e,t){return d.a.get("https://toms-news-api.herokuapp.com/api/articles/".concat(e,"/comments"),{params:{p:t&&t.page}}).then((function(e){return e.data.comments}))},v=function(e,t,a){return d.a.post("https://toms-news-api.herokuapp.com/api/articles/".concat(e,"/comments"),{username:t,body:a}).then((function(e){return e.data.comment}))},E=function(e){return d.a.delete("https://toms-news-api.herokuapp.com/api/comments/".concat(e))},b=function(e,t){return d.a.patch("https://toms-news-api.herokuapp.com/api/articles/".concat(e),{inc_votes:t})},C=function(e,t){return d.a.patch("https://toms-news-api.herokuapp.com/api/comments/".concat(e),{inc_votes:t})};function k(e){return r.a.createElement("header",{className:"header"},r.a.createElement("h1",null,"NC News"))}function y(e){console.dir(e.error);var t=e.error.response.status,a=e.error.response.data.msg;return r.a.createElement("section",{className:"errInfo"},r.a.createElement("p",null,"Uh Oh, an error has occurred!"),r.a.createElement("p",null,"Status : ",t),r.a.createElement("p",null,"Error Message : ",a))}var O=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={topicList:[],curOption:"Select a topic",error:null},a.handleClick=function(e){"notChose"!==e.target.value?(Object(p.c)("/topics/".concat(e.target.value)),a.setState({curOption:e.target.value})):(Object(p.c)("/articles"),a.setState({curOption:"Select a topic"}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.error?r.a.createElement(y,{error:this.state.error}):r.a.createElement("select",{name:"topicSelect",id:"topicNav",onChange:this.handleClick,value:this.state.curOption},r.a.createElement("option",{value:"notChose"},"Select a topic"),this.state.topicList.map((function(e){return r.a.createElement("option",{key:e.slug,value:e.slug},e.slug)})))}},{key:"componentDidMount",value:function(){var e=this;d.a.get("https://toms-news-api.herokuapp.com/api/topics").then((function(e){return e.data.topics})).then((function(t){e.setState({topicList:t})})).catch((function(t){e.setState({error:t})}))}},{key:"componentDidUpdate",value:function(){this.props.setDefault&&(this.setState({curOption:"Select a topic"}),this.props.resetDefault())}}]),t}(n.Component),S=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={setDefault:!1},a.handleClick=function(){a.setState({setDefault:!0})},a.resetDefault=function(){a.setState({setDefault:!1})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",{className:"nav"},r.a.createElement(p.a,{to:"/"},r.a.createElement("button",{onClick:this.handleClick,className:"customBtn"},"Home")),r.a.createElement(p.a,{to:"/articles"},r.a.createElement("button",{onClick:this.handleClick,className:"customBtn"},"All articles")),r.a.createElement(O,{setDefault:this.state.setDefault,resetDefault:this.resetDefault}))}}]),t}(n.Component),j=a(9),L=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={votes:0,upvoteClicked:!1,downvoteClicked:!1,error:null},a.handleUpVoteClick=function(e){var t=Number(e.target.value);a.state.upvoteClicked&&(t=-1),a.setState((function(e){return{votes:e.votes+t,upvoteClicked:!e.upvoteClicked}})),a.updateVotes(t)},a.handleDownVoteClick=function(e){var t=Number(e.target.value);a.state.downvoteClicked&&(t=1),a.setState((function(e){return{votes:e.votes+t,downvoteClicked:!e.downvoteClicked}})),a.updateVotes(t)},a.updateVotes=function(e){a.props.article_id?b(a.props.article_id,e).catch((function(e){a.setState({error:e})})):a.props.comment_id&&C(a.props.comment_id,e).catch((function(e){a.setState({error:e})}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.error?r.a.createElement(y,{error:this.state.error}):r.a.createElement("section",{className:"votingSection"},r.a.createElement("section",{className:"votingBtns"},r.a.createElement("button",{disabled:!this.props.user||!0===this.state.downvoteClicked,value:"1",onClick:this.handleUpVoteClick,className:this.state.upvoteClicked?"upvoteClicked":"voteBtn"},"\u2191"),r.a.createElement("button",{disabled:!this.props.user||!0===this.state.upvoteClicked,value:"-1",onClick:this.handleDownVoteClick,className:this.state.downvoteClicked?"downvoteClicked":"voteBtn"},"\u2193")),r.a.createElement("p",null,"Votes:",this.state.votes))}},{key:"componentDidMount",value:function(){this.setState({votes:this.props.votes})}}]),t}(n.Component),_=/\d{4}-\d{2}-\d{2}/;function w(e){return r.a.createElement("li",{className:"articleCard"},r.a.createElement("section",{className:"articleCardText"},r.a.createElement(p.a,{to:"/articles/".concat(e.article.article_id)},r.a.createElement("p",null,e.article.title)),r.a.createElement("p",null),r.a.createElement("p",null),r.a.createElement("p",null,r.a.createElement("i",null,"Written by ",e.article.author," ",r.a.createElement("br",null),e.article.comment_count," comments ",r.a.createElement("br",null),"Created on"," ",e.article.created_at.match(_)[0].split("-").reverse().join("-")))),r.a.createElement(L,{user:e.user,votes:e.article.votes,article_id:e.article.article_id}))}function N(e){return r.a.createElement("select",{name:"articleSort",onChange:e.changeQuery},r.a.createElement("option",{value:"default"},"Most recent"),r.a.createElement("option",{value:"order=asc"},"Oldest first"),r.a.createElement("option",{value:"sortBy=comment_count"},"Most commented"),r.a.createElement("option",{value:"sortBy=comment_count=order=asc"},"Least commented"),r.a.createElement("option",{value:"sortBy=votes"},"Most popular"),r.a.createElement("option",{value:"sortBy=votes=order=asc"},"Least popular"))}var P=a(24),U=a.n(P);function A(){return r.a.createElement("section",{className:"loadingElement"},r.a.createElement(U.a,{type:"bubbles",color:"black",className:"loadingBubbles"}))}var D=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={articles:[],total_articles:0,curPage:1,article_count:0,sortQuery:{sortBy:null,order:null},isLoading:!0,error:null},a.nextPage=function(){a.state.article_count<a.state.total_articles&&(a.setState({isLoading:!0}),a.fetchArticles(Object(j.a)({page:a.state.curPage+1,topic:a.props.topic,author:a.props.author},a.state.sortQuery),{inc:!0}))},a.prevPage=function(){a.state.curPage>1&&(a.setState({isLoading:!0}),a.fetchArticles(Object(j.a)({page:a.state.curPage-1,topic:a.props.topic,author:a.props.author},a.state.sortQuery),{dec:!0}))},a.fetchArticles=function(e,t){t?(t.inc&&g(e).then((function(e){var t=e.articles;a.setState((function(e){return{articles:t,curPage:e.curPage+1,article_count:e.article_count+t.length,isLoading:!1}}))})).catch((function(e){a.setState({error:e,isLoading:!1})})),t.dec&&g(e).then((function(e){var t=e.articles;a.setState((function(e){return{articles:t,curPage:e.curPage-1,article_count:e.article_count-e.articles.length,isLoading:!1}}))})).catch((function(e){a.setState({error:e,isLoading:!1})})),t.update&&g(e).then((function(e){var t=e.articles;a.setState({articles:t,isLoading:!1})})).catch((function(e){a.setState({error:e,isLoading:!1})}))):g(e).then((function(e){var t=e.articles,n=e.total_articles;a.setState({articles:t,total_articles:n,article_count:t.length,isLoading:!1})})).catch((function(e){a.setState({error:e,isLoading:!1})}))},a.changeSortQuery=function(e){if("default"!==e.target.value){var t=e.target.value.split("="),n={};t.forEach((function(e,a){a%2===0&&(n[e]=t[a+1])})),a.setState({sortQuery:n,isLoading:!0})}else a.setState({sortQuery:{sortBy:null,order:null},isLoading:!0})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return this.state.error?r.a.createElement(y,{error:this.state.error}):r.a.createElement("section",{className:"articlesPage"},r.a.createElement(N,{changeQuery:this.changeSortQuery}),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.prevPage,className:"customBtn"},"<"," "),r.a.createElement("button",{onClick:this.nextPage,className:"customBtn"},">"),this.state.isLoading?r.a.createElement(A,null):r.a.createElement("ul",{className:"allArticlesList"},this.state.articles.map((function(t){return r.a.createElement(w,{article:t,key:t.article_id,user:e.props.user})}))),r.a.createElement("button",{onClick:this.prevPage,className:"customBtn"},"<"," "),r.a.createElement("button",{onClick:this.nextPage,className:"customBtn"},">"))}},{key:"componentDidMount",value:function(){this.fetchArticles(Object(j.a)({page:this.state.curPage,topic:this.props.topic,author:this.props.author},this.state.sortQuery))}},{key:"componentDidUpdate",value:function(e,t){t.sortQuery.sortBy!==this.state.sortQuery.sortBy||t.sortQuery.order!==this.state.sortQuery.order?this.fetchArticles(Object(j.a)({page:this.state.curPage,topic:this.props.topic,author:this.props.author},this.state.sortQuery),{update:!0}):e.topic!==this.props.topic&&this.fetchArticles(Object(j.a)({page:this.state.curPage,topic:this.props.topic,author:this.props.author},this.state.sortQuery))}}]),t}(n.Component),B=a(11),I=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={commentInput:"Enter your comment here.",error:null},a.validateInput=function(e){a.setState({commentInput:e.target.value})},a.removeDefaultText=function(e){"Enter your comment here."===e.target.value&&a.setState({commentInput:""})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.commentInput;"Enter your comment here."!==t&&v(Number(a.props.article_id),a.props.user,t).then((function(e){a.props.commentIsAdded(e),a.setState({commentInput:"Enter your comment here."})})).catch((function(e){a.setState({error:e})}))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.error?r.a.createElement(y,{error:this.state.error}):this.props.user?r.a.createElement("section",{className:"commentAdder"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",null,r.a.createElement("b",null,this.props.user," : "),r.a.createElement("textarea",{required:!0,id:"commentInput",value:this.state.commentInput,onChange:this.validateInput,onClick:this.removeDefaultText})),r.a.createElement("button",{type:"submit"},"Add comment."))):r.a.createElement("p",null,"You must be logged in to add a comment! ")}}]),t}(n.Component);function Q(e){return r.a.createElement("section",{className:"commentAndVotes"},r.a.createElement("li",{className:"commentCard"},r.a.createElement("b",null,e.comment.author," : ")," ",e.comment.body)," ",r.a.createElement(L,{user:e.user,comment_id:e.comment.comment_id,votes:e.comment.votes}),e.user===e.comment.author&&r.a.createElement("button",{id:e.comment.comment_id,onClick:e.handleClick,className:"customBtn"},"Delete comment"))}var M=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={comments:[],curPage:1,isLoading:!0,error:null},a.fetchComments=function(){f(a.props.article_id).then((function(e){a.setState({comments:e,curPage:1,isLoading:!1})})).catch((function(e){a.setState({error:e,isLoading:!1})}))},a.commentIsAdded=function(e){a.setState((function(t){return a.props.updateCommentTotal(1),{comments:[e].concat(Object(B.a)(t.comments))}}))},a.handleDeleteClick=function(e){E(e.target.id).then((function(){a.fetchComments(),a.props.updateCommentTotal(-1)})).catch((function(e){a.setState({error:e,isLoading:!1})}))},a.loadNextPage=function(){a.state.comments.length<a.props.total_comments&&a.setState({isLoading:!0}),f(a.props.article_id,{page:a.state.curPage+1}).then((function(e){a.setState((function(t){var a=t.comments.map((function(e){return Object.assign({},e)}));return a.push.apply(a,Object(B.a)(e)),{comments:a,curPage:t.curPage+1,isLoading:!1}}))})).catch((function(e){a.setState({error:e,isLoading:!1})}))},a.loadFirstPage=function(){a.fetchComments()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return this.state.isLoading?r.a.createElement(A,null):this.state.error?r.a.createElement(y,{error:this.state.error}):r.a.createElement("section",{className:"articleComments"},r.a.createElement("br",null),r.a.createElement(I,{user:this.props.user,article_id:this.props.article_id,commentIsAdded:this.commentIsAdded}),r.a.createElement("ul",null,this.state.comments.map((function(t){return r.a.createElement(Q,{user:e.props.user,comment:t,key:t.comment_id,handleClick:e.handleDeleteClick})}))),this.state.comments.length<this.props.total_comments?r.a.createElement(p.a,{to:"/articles/".concat(this.props.article_id,"/comments"),onClick:this.loadNextPage},"Show more comments"):this.state.curPage>1&&r.a.createElement(p.a,{to:"/articles/".concat(this.props.article_id,"/comments"),onClick:this.loadFirstPage},"Show less"))}},{key:"componentDidMount",value:function(){this.fetchComments(),this.props.trueOnMount()}}]),t}(n.Component),x=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={article:{},showComment:!1,isLoading:!0,error:null},a.showHideComments=function(){a.setState((function(e){return e.showComment?Object(p.c)("/articles/".concat(a.props.article_id)):Object(p.c)("/articles/".concat(a.props.article_id,"/comments")),{showComment:!e.showComment}}))},a.updateCommentCount=function(e){a.setState((function(t){return{article:Object(j.a)({},t.article,{comment_count:t.article.comment_count+e})}}))},a.setTrueOnCommentsMount=function(){a.setState({showComment:!0})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.isLoading?r.a.createElement(A,null):this.state.error?r.a.createElement(y,{error:this.state.error}):r.a.createElement("section",{className:"singleArticlePage"},r.a.createElement("h4",null,this.state.article.title),r.a.createElement("p",null,this.state.article.body),r.a.createElement("p",null,r.a.createElement("i",null,"Written by ",this.state.article.author)),r.a.createElement("button",{onClick:this.showHideComments},this.state.showComment?"Hide comments":"Show comments (".concat(this.state.article.comment_count,")")),r.a.createElement(p.b,null,r.a.createElement(M,{path:"/comments",user:this.props.user,total_comments:this.state.article.comment_count,updateCommentTotal:this.updateCommentCount,trueOnMount:this.setTrueOnCommentsMount})))}},{key:"componentDidMount",value:function(){var e,t=this;(e=this.props.article_id,d.a.get("https://toms-news-api.herokuapp.com/api/articles/".concat(e)).then((function(e){return e.data.article}))).then((function(e){t.setState({article:e,isLoading:!1})})).catch((function(e){t.setState({error:e,isLoading:!1})}))}}]),t}(n.Component);function T(e){return r.a.createElement("section",{className:"topicList"},r.a.createElement("h2",null,"Topic : ",e.topic_slug),r.a.createElement(D,{topic:e.topic_slug,user:e.user}))}var V=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={users:[],isLoading:!0,error:null},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return this.state.isLoading?r.a.createElement(A,null):this.state.error?r.a.createElement(y,{error:this.state.error}):this.props.user?r.a.createElement("section",{className:"homePage"},r.a.createElement("p",null,"You are logged in as: ",this.props.user),r.a.createElement("h3",null,"Your Articles:"),r.a.createElement(D,{author:this.props.user,user:this.props.user}),r.a.createElement("button",{value:null,onClick:this.props.handleLogin,className:"customBtn"},"Logout")):r.a.createElement("section",{className:"homePage"},r.a.createElement("h3",null,"Login"),this.state.users.map((function(t){return r.a.createElement("p",{key:t.username},r.a.createElement("img",{className:"loginAvatar",src:t.avatar_url,alt:"".concat(t.username," profile avatar")}),r.a.createElement("br",null),t.username," ",r.a.createElement("button",{value:t.username,onClick:e.props.handleLogin,className:"customBtn"},"Login"))})))}},{key:"componentDidMount",value:function(){var e=this;d.a.get("https://toms-news-api.herokuapp.com/api/users").then((function(e){return e.data.users})).then((function(t){e.setState({users:t,isLoading:!1})})).catch((function(t){e.setState({error:t,isLoading:!1})}))}}]),t}(n.Component);function H(e){return r.a.createElement("section",{className:"logInfo"},e.loggedUser?r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("img",{src:e.loggedUserImg,alt:"".concat(e.loggedUser," profile avatar"),className:"smallLoginAvatar"}),r.a.createElement("br",null),e.loggedUser),r.a.createElement("br",null),r.a.createElement("button",{value:null,onClick:e.handleLogin,id:"permLogoutBtn",className:"customBtn"},"Logout")):r.a.createElement(p.a,{to:"/"},r.a.createElement("button",{className:"customBtn"},"Login")))}var W=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={loggedUser:null,loggedUserImg:null,error:null},a.handleLoginLogout=function(e){var t=e.target.value;a.setState({loggedUser:t}),localStorage.setItem("loggedUser",t)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.error?r.a.createElement(y,{error:this.state.error}):r.a.createElement("div",{className:"App"},r.a.createElement("section",{className:"topOfPage"},r.a.createElement(H,{loggedUser:this.state.loggedUser,loggedUserImg:this.state.loggedUserImg,handleLogin:this.handleLoginLogout}),r.a.createElement(k,{user:this.state.loggedUser,className:"header"}),r.a.createElement(S,null)),r.a.createElement(p.b,{className:"mainContent"},r.a.createElement(V,{path:"/",user:this.state.loggedUser,handleLogin:this.handleLoginLogout}),r.a.createElement(D,{path:"/articles",user:this.state.loggedUser}),r.a.createElement(x,{path:"/articles/:article_id/*",user:this.state.loggedUser}),r.a.createElement(T,{path:"/topics/:topic_slug",user:this.state.loggedUser})))}},{key:"componentDidMount",value:function(){this.setState({loggedUser:localStorage.getItem("loggedUser")})}},{key:"componentDidUpdate",value:function(e,t){var a,n=this;t.loggedUser!==this.state.loggedUser&&this.state.loggedUser&&(a=this.state.loggedUser,d.a.get("https://toms-news-api.herokuapp.com/api/users/".concat(a)).then((function(e){return e.data.user}))).then((function(e){n.setState({loggedUserImg:e.avatar_url})})).catch((function(e){n.setState({error:e})}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[25,1,2]]]);
//# sourceMappingURL=main.4e360773.chunk.js.map